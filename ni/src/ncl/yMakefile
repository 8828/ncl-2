#
#      $Id: yMakefile,v 1.11 1994-07-15 17:08:21 ethan Exp $
#
#########################################################################
#									#
#			   Copyright (C)  1993				#
#	     University Corporation for Atmospheric Research		#
#			   All Rights Reserved				#
#									#
#########################################################################
#
#	File:		
#
#	Author:		Ethan Alpert
#			National Center for Atmospheric Research
#			PO 3000, Boulder, Colorado
#
#	Date:		Fri Sep 24 09:53:33 MDT 1993
#
#	Description:	
#
#	Usage:
#
#	Environment:
#
#	Files:
#
#
#	Options:

#ifdef  HPUX
SYS_LIBS        =       $(CTOFLIBS) -lm -lPW -ll
#else
SYS_LIBS        =       $(CTOFLIBS) -lm 
#endif

#define IHaveSubdirs



MYNAME = ncl

PROG_LIBS	=	$(HLULIBS) $(CNCARGLIBS) $(NCARGLIBS)
EXTRA_LIBS	=	-ll $(NCDFLIBS) $(XMOTIFCLIENTLIBS) 

HDRS	= AttSupport.h NclMultiDValfloatData.h DataSupport.h \
	NclMultiDValintData.h FileSupport.h NclMultiDVallogicalData.h \
	Keywords.h NclMultiDVallongData.h Machine.h NclMultiDValnclfileData.h \
	NclApi.h NclMultiDValshortData.h NclAtt.h NclMultiDValstringData.h \
	NclData.h NclVar.h NclDataDefs.h OpsFuncs.h NclFile.h OpsList.h \
	NclFileInterfaces.h SrcTree.h NclHLUObj.h Symbol.h NclMdInc.h \
	VarSupport.h NclMultiDValData.h defs.h NclMultiDValHLUObjData.h \
	y.tab.h NclMultiDValdoubleData.h


API_SRCS	= NclApi.c
EXE_SRCS	= Ncl.c

APISRCS		= $(API_SRCS) $(SRCS)
EXESRCS		= $(EXE_SRCS) $(SRCS)
ALLSRCS		= $(API_SRCS) $(EXE_SRCS) $(SRCS)

SRCS	= AddBuiltIns.c AddFileFormats.c AddHLUObjs.c AddIntrinsics.c \
	AttSupport.c DataSupport.c Execute.c FileSupport.c Formats.c \
	InitData.c Machine.c Memory.c NclAtt.c NclData.c \
	NclFile.c NclHLUObj.c NclMultiDValData.c NclMultiDValHLUObjData.c \
	NclMultiDValdoubleData.c NclMultiDValfloatData.c NclMultiDValintData.c \
	NclMultiDVallogicalData.c NclMultiDVallongData.c \
	NclMultiDValnclfileData.c NclMultiDValshortData.c \
	NclMultiDValstringData.c NclNetCdf.c NclVar.c OpsFuncs.c Printtoken.c \
	SrcTree.c Symbol.c Translate.c VarSupport.c lex.yy.c y.tab.c yywrap.c


API_OBJS	= NclApi.o
EXE_OBJS	= Ncl.o

OBJS	= AddBuiltIns.o AddFileFormats.o AddHLUObjs.o AddIntrinsics.o \
	AttSupport.o DataSupport.o Execute.o FileSupport.o Formats.o \
	InitData.o Machine.o Memory.o NclAtt.o NclData.o \
	NclFile.o NclHLUObj.o NclMultiDValData.o NclMultiDValHLUObjData.o \
	NclMultiDValdoubleData.o NclMultiDValfloatData.o NclMultiDValintData.o \
	NclMultiDVallogicalData.o NclMultiDVallongData.o \
	NclMultiDValnclfileData.o NclMultiDValshortData.o \
	NclMultiDValstringData.o NclNetCdf.o NclVar.o OpsFuncs.o Printtoken.o \
	SrcTree.o Symbol.o Translate.o VarSupport.o lex.yy.o y.tab.o yywrap.o

APIOBJS	= $(API_OBJS) $(OBJS)
EXEOBJS	= $(EXE_OBJS) $(OBJS)
ALLOBJS = $(API_OBJS) $(OBJS) $(EXE_OBJS)

InstallTarget(ncl,$(INSTALL_INC),$(XAPPPATH))
InstallTarget(libncl.a,$(INSTALL_LIB),$(LIBPATH))
DependTarget($(EXESRCS))

ncl:: $(EXEOBJS) $(DEPLIBS)
	$(CC_LD) $(CC_LDOPTIONS) -o ncl $(EXEOBJS) $(PROG_LIBS) $(CSTATIC) $(LDLIBS) $(CDYNAMIC) $(EXTRA_LDLIBS)
InstallTarget(ncl, $(INSTALL_BIN),$(BINPATH))
CleanFilesTarget(ncl $(ALLOBJS) y.tab.c y.tab.h lex.yy.c)

libncl.a::
	-$(RM) $(APIOBJS) y.tab.h y.tab.c lex.yy.c
	$(YACC) -d -t -v ncl.y
	$(LEX) ncl.l
	$(CC_LD) $(CC_LDOPTIONS) -c $(TOP_INCLUDES) -DMAKE_API $(APISRCS)
	-$(RM) libncl.a
	@$(AR_QUICK) libncl.a $(ALLOBJS)
	$(RANLIB) libncl.a
	-$(RM) $(APIOBJS)


# Special dependencies

lex.yy.c: ncl.l
	$(LEX) ncl.l

y.tab.c: ncl.y
	$(YACC) -d -t -v ncl.y

y.tab.h: ncl.y
	$(YACC) -d -t -v ncl.y

Ncl.c: y.tab.h

Printtoken.c: y.tab.h

SrcTree.c: y.tab.h

Translate.c: y.tab.h

yywrap.c: y.tab.h
